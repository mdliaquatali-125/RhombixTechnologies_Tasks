
@model To_Do_List.Models.TaskModel


@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .search-box {
        position: relative;
    }

        .search-box input {
            padding-left: 35px;
            border-radius: 8px;
        }

        .search-box i {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            color: #777;
            font-size: 14px;
        }
</style>

<div class="content-body">
    <div class="container-fluid">
        <div class="row page-titles">
            <div class="col-sm-6 p-md-0">
                <div class="welcome-text">
                    <h4 id="greeting" class="mt-3 mb-2">Hello!</h4>
                    <span id="date-time" class="mt-5 mb-3">Loading date and time...</span>
                </div>
            </div>
            <div class="col-sm-6 p-md-0 justify-content-sm-end mt-5 mt-sm-0 d-flex">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                    <li class="breadcrumb-item active"><a href="javascript:void(0)">Edit Task</a></li>
                </ol>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        @using (Ajax.BeginForm("Edit", "Dashboard",
        new AjaxOptions
        {
            HttpMethod = "POST",
            OnBegin = "OnBeginAjax",
            OnSuccess = "OnSuccessAjax",
            OnFailure = "OnFailureAjax"
        },
        new { enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div class="row">
                <div class="col-xl-12 col-lg-9 col-md-10 mx-auto">
                    <div class="card shadow-sm">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-3">
                                <i class="la la-minus"></i> Edit Task
                            </h5>
                        </div>
                        @Html.HiddenFor(model => model.TaskID)
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Task Title</label>
                                    @Html.TextBoxFor(model => model.TaskTitle, new { @class = "form-control input", placeholder = "Enter Task Title", required = "" })
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Select  Priority </label>
                                    @Html.DropDownListFor(model => model.TaskPriority,
     new List<SelectListItem>()
     {
         new SelectListItem { Text = "Select Priority", Value = "" },
         new SelectListItem { Text = "Low", Value = "Low" },
         new SelectListItem { Text = "Medium", Value = "Medium" },
         new SelectListItem { Text = "High", Value = "High" }
     },
     new { @class = "form-control", required = "" })

                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Category</label>
                                    @Html.TextBoxFor(model => model.TaskCategory, new { @class = "form-control input", placeholder = "Enter Task Category", required = "" })
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Date</label>
                                    @Html.TextBoxFor(model => model.TaskDate,
    new
{
        @class = "form-control input",
        type = "date",
        required = "",
        Value = (Model != null && Model.TaskDate.HasValue)
            ? Model.TaskDate.Value.ToString("yyyy-MM-dd")
            : ""
    })



                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Description </label>
                                    @Html.TextBoxFor(model => model.TaskDescription, new { @class = "form-control input", row = 4, required = "", placeholder = "Enter description" })
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Select  Priority </label>
                                    @Html.DropDownListFor(model => model.Status,
     new List<SelectListItem>()
     {
         new SelectListItem { Text = "Select Status", Value = "" },
         new SelectListItem { Text = "Pending", Value = "Pending" },
         new SelectListItem { Text = "In Progress", Value = "In Progress" },
         new SelectListItem { Text = "Complete", Value = "Complete" }
     },
     new { @class = "form-control", required = "" })

                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>

            <div class="text-center">
                <button class="btn btn-primary px-4">Edit Task</button>
            </div>
        }
    </div>
</div>

<!--JS Script-->
<script>
    function updateDateTime() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const seconds = now.getSeconds().toString().padStart(2, '0');
        const day = now.toLocaleDateString('en-GB', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Greeting based on time
        let greeting = "Hello!";
        if (hours >= 5 && hours < 12) {
            greeting = "Good Morning!";
        } else if (hours >= 12 && hours < 17) {
            greeting = "Good Afternoon!";
        } else if (hours >= 17 && hours < 21) {
            greeting = "Good Evening!";
        } else {
            greeting = "Good Night!";
        }

        // Update DOM
        document.getElementById("greeting").innerText = greeting;
        document.getElementById("date-time").innerText = `${day} | ${hours}:${minutes}:${seconds}`;
    }

    // Update every second
    setInterval(updateDateTime, 1000);
    updateDateTime(); // Initial call
</script>

<script>
    function OnBeginAjax() {
        Swal.fire({
            icon: "info",
            title: "Working on it!",
            text: "Please wait.",
            allowOutsideClick: false,
            didOpen: () => Swal.showLoading()
        });
    }

    function OnSuccessAjax(res) {
        if (res.Status === "Success") {
            Swal.fire({
                icon: "success",
                title: "Good Job!",
                text: res.Message,
                showConfirmButton: true
            }).then(() => { window.location.href = res.URL; });
        } else if (res.Status === "CatchError") {
            window.location.href = res.URL;
        } else {
            Swal.fire({
                icon: "error",
                title: "Error!",
                text: res.Message,
                showConfirmButton: true
            }).then(() => { window.location.href = res.URL; });
        }
    }

    function OnFailureAjax(res) {
        Swal.fire({
            icon: "error",
            title: "Failed!",
            text: res.Message,
            showConfirmButton: true
        }).then(() => {
            if (res.URL && res.URL !== "") { window.location.href = res.URL; }
        });
    }
</script>